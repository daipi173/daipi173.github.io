<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!--<![endif]-->

<head>
  <title>执行上下文 | daipi173的个人博客</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="daipi173的个人博客">
    <meta name="author" content="daipi173">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="daipi173的个人博客" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/HTML/CSS/" class="animsition-link">CSS<small>(4)</small></a></li>
				    
				    <li><a href="/categories/ES6/" class="animsition-link">ES6<small>(4)</small></a></li>
				    
				    <li><a href="/categories/JavaScript/ES6/" class="animsition-link">ES6<small>(2)</small></a></li>
				    
				    <li><a href="/categories/Git/" class="animsition-link">Git<small>(1)</small></a></li>
				    
				    <li><a href="/categories/HTML/" class="animsition-link">HTML<small>(16)</small></a></li>
				    
				    <li><a href="/categories/JavaScript/" class="animsition-link">JavaScript<small>(24)</small></a></li>
				    
				    <li><a href="/categories/ES6/JavaScript/" class="animsition-link">JavaScript<small>(4)</small></a></li>
				    
				    <li><a href="/categories/vue/" class="animsition-link">vue<small>(1)</small></a></li>
				    
				    <li><a href="/categories/webpack/" class="animsition-link">webpack<small>(2)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="https://daipi173.github.io/myweb/daipi173-myperson" class="animsition-link">Personal Project</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">daipi173的个人博客</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2019-08-05T09:15:00.000Z" itemprop="datePublished">
          2019-08-05
      </time>
    
    
    | 
    <a href='/tags/JavaScript/'>JavaScript</a>,
    
    <a href='/tags/闭包/'>闭包</a>,
    
    <a href='/tags/this/'>this</a>,
    
    <a href='/tags/执行上下文/'>执行上下文</a>
    
    
</span>
                <h1>执行上下文</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h1 id="1-执行上下文是什么"><a href="#1-执行上下文是什么" class="headerlink" title="1. 执行上下文是什么"></a>1. 执行上下文是什么</h1><p>当执行一段代码的时候，就会进行准备工作，这里的“准备工作”，让我们用个更专业一点的说法，就叫做“执行上下文(execution context)”。</p>
<h1 id="2-执行上下文是怎样产生的"><a href="#2-执行上下文是怎样产生的" class="headerlink" title="2. 执行上下文是怎样产生的"></a>2. 执行上下文是怎样产生的</h1><p>执行上下文会产生<strong>三种</strong>执行上下文，分别是：</p>
<ol>
<li>全局执行上下文（刚开始执行script标签或者刚开始执行js代码的时候就会产生）；</li>
<li>函数执行上下文；</li>
<li>eval执行上下文（了解一下即可，因为现在不太使用了）。</li>
</ol>
<h1 id="3-执行上下文产生的时候发生了什么"><a href="#3-执行上下文产生的时候发生了什么" class="headerlink" title="3. 执行上下文产生的时候发生了什么"></a>3. 执行上下文产生的时候发生了什么</h1><p>每个执行上下文中都会有<strong>三个</strong>重要的属性：</p>
<ol>
<li>变量对象（VO），包含变量、函数声明和函数的形参，该属性只能在<strong>全局</strong>上下文中访问；</li>
<li>作用域链（JS采用词法作用域，也就是说变量的作用域是在<strong>定义</strong>的时候就决定了）；</li>
<li>this指向。</li>
</ol>
<h1 id="4-执行上下文栈的作用是什么"><a href="#4-执行上下文栈的作用是什么" class="headerlink" title="4. 执行上下文栈的作用是什么"></a>4. 执行上下文栈的作用是什么</h1><p>接下来我们先来看一段代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'fun3'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            fun3();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            fun2();</span><br><span class="line">        &#125;</span><br><span class="line">        fun1();  <span class="comment">// fun3</span></span><br></pre></td></tr></table></figure>

<p>这段代码是很简单，我们可以很快的就得出打印的内容为fun3。但是引擎没有我们那么智能，它需要知道它是如何进行一个先后顺序来执行的，那么引擎该如何管理创建的那么多执行上下文呢？<br>JavaScript引擎创建了<strong>执行上下文栈</strong>（Execution context stack，ECS）来管理执行上下文。<br>关于上面的代码，接下来我会画一张图来解释执行上下文栈是怎么执行的：<br><a href="https://s2.ax1x.com/2019/08/05/egis2V.png" title="执行上下文栈执行过程" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/08/05/egis2V.png" alt="执行上下文栈执行过程" title="执行上下文栈执行过程"></a></p>
<h1 id="5-什么是变量对象"><a href="#5-什么是变量对象" class="headerlink" title="5. 什么是变量对象"></a>5. 什么是变量对象</h1><p>变量对象：是与执行上下文相关的数据作用域，存储了在上下文中定义的变量和函数声明。</p>
<ol>
<li>全局上下文的变量对象初始化时全局对象；</li>
<li>函数上下文的变量对象初始化只包含Arguments对象（即<strong>实参</strong>）；</li>
<li>在<strong>进入执行上下文</strong>时会给变量对象添加形参、函数声明、变量声明等初始的属性值（即就是<strong>变量声明的提升</strong>）；</li>
<li>在<strong>代码执行</strong>阶段，会再次修改变量对象的属性值。</li>
</ol>
<h1 id="6-执行代码的时候分为三步"><a href="#6-执行代码的时候分为三步" class="headerlink" title="6. 执行代码的时候分为三步"></a>6. 执行代码的时候分为三步</h1><ol>
<li><p><strong>步骤一：初始化</strong><br>a. 全局上下文，就等价于全局对象window。<br>全局对象是<strong>预定义</strong>的对象，作为JavaScript的全局函数和全局属性的占位符。通过使用全局对象，可以访问所有其他所有预定义的对象、函数和属性。<br>在最顶层JavaScript代码中，可以用关键字this引用全局对象。因为全局对象是作用域链的头，这意味着所有非限定性的变量和函数名都会作为该对象的属性来查询。<br>例如，当JavaScript代码引用parseInt()函数时，它引用的是全局对象的parseInt属性。全局对象是作用域链的头，还意味着在顶层JavaScript代码中声明的所有变量都将成为全局对象的属性。<br>b. 函数上下文。<br>在函数上下文中，我们用活动对象（activation object,AO）来表示变量对象。活动对象和变量对象其实是一个东西，只是变量对象是规范上的或者说是引擎实现上的，不可在JavaScript环境中访问，只有到当进入一个执行上下文中，这个执行上下文的变量对象才会被激活（即只有当<strong>执行这个函数</strong>的时候才会被激活），所以才叫activation object的，而只有被激活的变量对象，也就是活动对象上的各种属性才能被访问。<br>活动对象是在进入函数上下文时被创建的，它通过函数的arguments属性初始化（即它初始化的值就是我们的一个实参）。arguments属性值是Arguments对象。</p>
</li>
<li><p><strong>步骤二：进入执行上下文</strong><br>变量对象会包括：<br>a. 函数的所有形参（如果是函数上下文）<br>（1） 由名称和对应值组成的一个变量对象的属性被创建；<br>（2） 没有实参，属性值设为undefined。<br>b. 函数声明<br>（1）由名称和对应值（函数对象（function-object））组成一个变量对象的属性被创建；<br>（2）如果变量对象已经存在相同名称的属性，则完全替换这个属性。<br>c. 变量声明<br>（1）由名称和对应值（undefined）组成一个变量对象的属性被创建；<br>（2）如果变量名称跟已经声明的形式参数或函数相同，则变量声明不会干扰已经存在的这类属性。</p>
</li>
<li><p><strong>步骤三：代码执行</strong><br>在代码执行阶段，会顺序执行代码，根据代码，修改变量对象的值。</p>
</li>
</ol>
<p>看完这些之后，我们来做一个小例子进行一个练习，代码和解析如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">    b = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(e);   <span class="comment">//报错；Uncaught ReferenceError: e is not defined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 错误的理解：</span></span><br><span class="line">    <span class="comment">// 如果我们说的词法作用域不是以定义函数它的父级来看，而是以执行函数的父级来看的话，</span></span><br><span class="line">    <span class="comment">// 它的父级就是bar，而不是Global全局，那么此时控制台打印出来就是e的值为1</span></span><br><span class="line">    foo(<span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">bar();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首先进行预编译过程（初始化）注意：下面显示的是伪代码</span></span><br><span class="line"><span class="comment">// foo函数进行一个预编译</span></span><br><span class="line"><span class="comment">// AO = &#123;</span></span><br><span class="line"><span class="comment">//     arguments: &#123;</span></span><br><span class="line"><span class="comment">//         0: 1,</span></span><br><span class="line"><span class="comment">//         length: 1</span></span><br><span class="line"><span class="comment">//     &#125;,</span></span><br><span class="line"><span class="comment">//     a: undefined-&gt;1,  表示从undefined变为1</span></span><br><span class="line"><span class="comment">//     b: undefined,</span></span><br><span class="line"><span class="comment">//     c: function()&#123;&#125;,</span></span><br><span class="line"><span class="comment">//     d: undefined,</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 接着就是代码执行阶段</span></span><br><span class="line"><span class="comment">// foo函数执行</span></span><br><span class="line"><span class="comment">// AO = &#123;</span></span><br><span class="line"><span class="comment">//     arguments: &#123;</span></span><br><span class="line"><span class="comment">//         0: 1,</span></span><br><span class="line"><span class="comment">//         length: 1</span></span><br><span class="line"><span class="comment">//     &#125;,</span></span><br><span class="line"><span class="comment">//     a: 1,</span></span><br><span class="line"><span class="comment">//     b: undefined-&gt;2-&gt;3,</span></span><br><span class="line"><span class="comment">//     c: function()&#123;&#125;,</span></span><br><span class="line"><span class="comment">//     d: undefined-&gt;function()&#123;&#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在分析完成之后，此时就会去找e的值为多少，首先它会先去自己的AO中查找，发现没有找到e属性，然后它又</span></span><br><span class="line"><span class="comment">// 会去词法作用域的父级去找（即定义foo函数的父级，它是一个Global全局）,最后发现也没有e属性，然后</span></span><br><span class="line"><span class="comment">// 最后会在控制台报错，提示你没有定义e</span></span><br></pre></td></tr></table></figure>

<h1 id="7-什么是作用域链"><a href="#7-什么是作用域链" class="headerlink" title="7. 什么是作用域链"></a>7. 什么是作用域链</h1><p>当查找变量的时候，会先从当前上下文的变量对象中查找，如果没有找到，就会从父级（词法层面上的父级，即定义函数它的父级，而不是执行函数的一个父级）执行上下文的变量对象中查找，一直找到全局上下文的变量对象，也就是全局对象。这样由多个执行上下文的变量对象构成的链表就叫做作用域链。</p>
<h1 id="8-函数创建和函数激活"><a href="#8-函数创建和函数激活" class="headerlink" title="8. 函数创建和函数激活"></a>8. 函数创建和函数激活</h1><ol>
<li><p>函数创建<br>这是因为函数有一个内部属性[[scope]]，当函数创建（即<strong>函数定义</strong>）的时候，就会保存所有<strong>父变量对象</strong>到其中，你可以理解[[scope]]就是<strong>所有父变量对象的层级链</strong>，但是注意：<strong>[[scope]]并不代表完整的作用域链！！！</strong></p>
</li>
<li><p>函数激活<br>当函数激活时（即执行函数），进入函数上下文，创建VO/AO后，就会将<strong>活动对象</strong>添加到作用域链的<strong>前端</strong>。这时候执行上下文的作用域链，我们命名为scope：<code>scope = [AO].concat([[scope]])</code><br>举一个例子，代码如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// foo.[[scope]] = [</span></span><br><span class="line">        <span class="comment">//     fooContext.AO,</span></span><br><span class="line">        <span class="comment">//     globalContext.VO</span></span><br><span class="line">        <span class="comment">// ];</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// bar.[[scope]] = [</span></span><br><span class="line">        <span class="comment">//     barContext.AO,</span></span><br><span class="line">        <span class="comment">//     fooContext.AO,</span></span><br><span class="line">        <span class="comment">//     globalContext.VO</span></span><br><span class="line">        <span class="comment">// ]</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>接下来我们举一个实例，然后对上面的进行一个总结和练习，代码如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = <span class="string">"global scope"</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">checkscope</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> scope2 = <span class="string">"local scope"</span>;</span><br><span class="line">            <span class="keyword">return</span> scope2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(checkscope());   <span class="comment">// local scope</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析，伪代码：</span></span><br><span class="line">        <span class="comment">// 首先执行全局代码，创建全局执行上下文，全局上下文被压入执行上下文栈</span></span><br><span class="line">        <span class="comment">// ECStack = [globalContext]</span></span><br><span class="line">        <span class="comment">// 1. 全局的一个初始化</span></span><br><span class="line">        <span class="comment">// globalContext.VO = &#123;</span></span><br><span class="line">        <span class="comment">//     this: window,</span></span><br><span class="line">        <span class="comment">//     scope: [globalContext.VO],</span></span><br><span class="line">        <span class="comment">//     checkscope: function()&#123;&#125;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. checkscope函数被创建，保存作用域链到内部属性[[scope]]</span></span><br><span class="line">        <span class="comment">// checkscope.[[scope]] = [</span></span><br><span class="line">        <span class="comment">//     globalContext.VO</span></span><br><span class="line">        <span class="comment">// ];</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 执行checkscope函数，创建checkscope函数执行上下文，</span></span><br><span class="line">        <span class="comment">// checkscope函数执行上下文被压入执行上下文栈</span></span><br><span class="line">        <span class="comment">// ECStack = [</span></span><br><span class="line">        <span class="comment">//     checkscopeContext.AO,</span></span><br><span class="line">        <span class="comment">//     globalContext.VO</span></span><br><span class="line">        <span class="comment">// ]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. checkscope函数并不会立即执行，开始做准备工作，第一步：复制函数[[scope]]属性创建作用域链</span></span><br><span class="line">        <span class="comment">// checkscopeContext = &#123;</span></span><br><span class="line">        <span class="comment">//     scope: checkscope.[[scope]]</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// 第二步：用arguments创建活动对象，随后初始化活动对象，加入形参、函数声明、变量声明</span></span><br><span class="line">        <span class="comment">// checkscopeContext = &#123;</span></span><br><span class="line">        <span class="comment">//     AO: &#123;</span></span><br><span class="line">        <span class="comment">//         arguments: &#123;</span></span><br><span class="line">        <span class="comment">//             length: 0</span></span><br><span class="line">        <span class="comment">//         &#125;,</span></span><br><span class="line">        <span class="comment">//         scope2: undefined</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     scope: checkscope.[[scope]]</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// 第三步：将活动对象压入checkscope作用域链顶端</span></span><br><span class="line">        <span class="comment">// checkscopeContext = &#123;</span></span><br><span class="line">        <span class="comment">//     AO: &#123;</span></span><br><span class="line">        <span class="comment">//         arguments: &#123;</span></span><br><span class="line">        <span class="comment">//             length: 0</span></span><br><span class="line">        <span class="comment">//         &#125;,</span></span><br><span class="line">        <span class="comment">//         scope2: undefined</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     scope: [checkscopeContext.AO,globalContext.VO]</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">//5. 准备工作做完，开始执行checkscope函数，随着函数的执行，修改AO的属性值</span></span><br><span class="line">        <span class="comment">// checkscopeContext = &#123;</span></span><br><span class="line">        <span class="comment">//     AO: &#123;</span></span><br><span class="line">        <span class="comment">//         arguments: &#123;</span></span><br><span class="line">        <span class="comment">//             length: 0</span></span><br><span class="line">        <span class="comment">//         &#125;,</span></span><br><span class="line">        <span class="comment">//         scope2: "local scope"</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     scope: [checkscopeContext.AO,globalContext.VO]</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// 6. 查找到scope2的值为"local scope"，返回后函数执行完毕，如果没有找到的话，就会去</span></span><br><span class="line">        <span class="comment">// 它的作用域链找；函数上下文从执行上下文栈中弹出，然后最后在执行上下文栈中只剩全局的globalContext</span></span><br><span class="line">        <span class="comment">// ECStack = [</span></span><br><span class="line">        <span class="comment">//     globalContext.VO</span></span><br><span class="line">        <span class="comment">// ];</span></span><br></pre></td></tr></table></figure>
            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="m-pagination col-md-8 col-md-offset-2 col-sm-24" role="pagination">
    
    <a class="pull-left" href="/2019/08/07/常见的将元素水平垂直居中的方法/" style="float: left;">
        ← 常见的将元素水平垂直居中的方法
    </a>
    
    
    <a class="pull-right" href="/2019/08/03/关于this常用的场景总结/">
        关于this常用的场景总结 →
    </a>
    
</nav>

        <div class="col-md-8 col-md-offset-2 col-sm-24"><script type="text/javascript">
  /**
   * 搜狐畅言
   */

  /*
  document.write('<div id="SOHUCS" sid="' + window.location.pathname.slice(1) + '" ></div>');

  window.onload = function () {
    (function () {
      var appid = 'cytXXXX';
      var conf = 'prod_xxxxxxxxxxxxxxxxx';
      var width = window.innerWidth || document.documentElement.clientWidth;
      var loadJs = function (d, a, id) {
        var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
        var b = document.createElement("script");
        b.setAttribute("type", "text/javascript");
        b.setAttribute("charset", "UTF-8");
        b.setAttribute("src", d);
        if (id) {
          b.setAttribute("id", id);
        }
        if (typeof a === "function") {
          if (window.attachEvent) {
            b.onreadystatechange = function () {
              var e = b.readyState;
              if (e === "loaded" || e === "complete") {
                b.onreadystatechange = null;
                a()
              }
            }
          } else {
            b.onload = a
          }
        }
        c.appendChild(b)
      };

      loadJs("https://changyan.sohu.com/upload/changyan.js", function () {
        window.changyan.api.config({
          appid: appid,
          conf: conf
        })
      });
    })();
  }
  */

</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By daipi173. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



      
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
